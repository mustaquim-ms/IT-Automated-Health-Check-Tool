<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>System Health Report</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  body{font-family:Inter,system-ui,Segoe UI,Roboto,Arial; margin:0; padding:20px; background:#f5f7fb; color:#111}
  .container{max-width:1100px; margin:0 auto; background:#fff; border-radius:12px; padding:24px; box-shadow:0 6px 24px rgba(12,24,48,0.08)}
  header{display:flex; justify-content:space-between; align-items:center; margin-bottom:18px}
  h1{font-size:20px; margin:0}
  .meta{color:#556677; font-size:13px}
  .grid{display:grid; grid-template-columns:repeat(2,1fr); gap:16px; margin-top:18px}
  .card{background:#fbfdff; border:1px solid #e6eef6; padding:14px; border-radius:8px}
  pre{background:#0b1020; color:#e6f1ff; padding:10px; border-radius:6px; overflow:auto}
  table{width:100%; border-collapse:collapse}
  th,td{padding:8px; text-align:left; border-bottom:1px solid #eef4fb}
  .severity{font-weight:600}
  .ok{color:green} .warn{color:orange} .crit{color:#c53030}
  .section-title{font-size:16px; margin:10px 0 8px}
  .footer{margin-top:18px; color:#6b7b8a; font-size:13px}
  @media (max-width:800px){ .grid{grid-template-columns:1fr} }
</style>
</head>
<body>
  <div class="container">
    <header>
      <div>
        <h1>System Health Report</h1>
        <div class="meta" id="meta"></div>
      </div>
      <div style="text-align:right;">
        <div id="score" style="font-weight:700; font-size:18px"></div>
      </div>
    </header>

    <div class="grid">
      <div class="card">
        <div class="section-title">CPU</div>
        <canvas id="cpuChart" width="400" height="200"></canvas>
        <p id="cpuText"></p>
      </div>

      <div class="card">
        <div class="section-title">Memory</div>
        <canvas id="memChart" width="400" height="200"></canvas>
        <p id="memText"></p>
      </div>

      <div class="card">
        <div class="section-title">Disk</div>
        <table id="diskTable"><thead><tr><th>Mount</th><th>Free</th><th>Used</th><th>% Used</th></tr></thead><tbody></tbody></table>
      </div>

      <div class="card">
        <div class="section-title">Processes & Services</div>
        <table id="procTable"><thead><tr><th>Type</th><th>Count</th></tr></thead><tbody></tbody></table>
      </div>
    </div>

    <div style="margin-top:18px" class="card">
      <div class="section-title">Pending Updates & Vulnerabilities</div>
      <table id="updateTable"><thead><tr><th>Package/Update</th><th>Severity</th><th>Notes</th></tr></thead><tbody></tbody></table>
    </div>

    <div style="margin-top:18px" class="card">
      <div class="section-title">Logs (last 200 lines)</div>
      <pre id="logs"></pre>
    </div>

    <div style="margin-top:18px" class="card">
      <div class="section-title">Actionable Remediations</div>
      <ol id="remediationList"></ol>
    </div>

    <div class="footer">
      Generated by <strong>IT-Health-Check-Script</strong>. Timestamp: <span id="timestamp"></span>
    </div>
  </div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
/* INSERT_DATA_HERE */
(function render(data){
  document.getElementById('meta').innerText = data.host + ' • ' + data.os + ' • ' + data.ip;
  document.getElementById('timestamp').innerText = data.timestamp;
  document.getElementById('cpuText').innerText = "Load Avg: " + (data.cpu.load || 'N/A');
  document.getElementById('memText').innerText = "Free: " + (data.memory.free_human || 'N/A') + " / Total: " + (data.memory.total_human || 'N/A');

  // CPU chart
  new Chart(document.getElementById('cpuChart'), {
    type:'doughnut',
    data:{labels:['Used %','Free %'], datasets:[{data:[data.cpu.used_percent || 0,100-(data.cpu.used_percent||0)], backgroundColor:['#e85347','#e6f2ff']}]},
    options:{plugins:{legend:{display:false}}, cutout:'60%'}
  });

  new Chart(document.getElementById('memChart'), {
    type:'doughnut',
    data:{labels:['Used GB','Free GB'], datasets:[{data:[data.memory.used_gb || 0, data.memory.free_gb || 0], backgroundColor:['#4aa3ff','#f1f8ff']}]},
    options:{plugins:{legend:{display:false}}, cutout:'60%'}
  });

  // disks
  let dt = document.querySelector('#diskTable tbody');
  data.disks.forEach(d=> {
    let tr = document.createElement('tr');
    tr.innerHTML = `<td>${d.mount}</td><td>${d.free_human}</td><td>${d.used_human}</td><td>${d.percent}%</td>`;
    dt.appendChild(tr);
  });

  // procs
  let pt = document.querySelector('#procTable tbody');
  [{type:'Processes',count:data.processes.total},{type:'Services',count:data.services.running}].forEach(r=>{
    let tr = document.createElement('tr'); tr.innerHTML = `<td>${r.type}</td><td>${r.count}</td>`; pt.appendChild(tr);
  });

  // updates
  let ut = document.querySelector('#updateTable tbody');
  data.updates.forEach(u=>{
    let tr = document.createElement('tr');
    tr.innerHTML = `<td>${u.name}</td><td class="severity ${u.severity}">${u.severity.toUpperCase()}</td><td>${u.note||''}</td>`;
    ut.appendChild(tr);
  });

  // logs
  document.getElementById('logs').innerText = data.log || 'No logs';

  // remediations
  let rl = document.getElementById('remediationList');
  data.remediations.forEach(r=> { let li = document.createElement('li'); li.innerHTML = `<strong>${r.title}:</strong> ${r.action}`; rl.appendChild(li) });

  // score
  document.getElementById('score').innerText = 'Health Score: ' + (data.score || 'N/A');
})(REPORT_DATA);
</script>
</body>
</html>
